<ion-header>
  <ion-toolbar class="header">
    <ion-buttons slot="start">
      <ion-back-button style="color:#ffffff" text="" icon="arrow-back-outline"></ion-back-button>
    </ion-buttons>
    <ion-title color="primary" class="pLR50 titreFiche">{{plat.nom}}</ion-title>
    <div *ngIf="ficheUpdate">
      <ion-title>
        <ion-input class="pLR50 titreFiche" placeholder="{{plat.nom}}" type="text" [(ngModel)]="newNom" name="title"></ion-input>
      </ion-title>
    </div>
    <ion-buttons slot="end" *ngIf="!showButtonUpdate">
      <ion-icon style="color:#ffffff" icon="pencil" (click)="showUpdateFiche()"></ion-icon>
    </ion-buttons>
    <ion-buttons slot="end" *ngIf="showButtonUpdate">
      <ion-icon style="color:#ffffff" icon="arrow-redo-outline"></ion-icon>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-grid>
    <ion-row>
      <ion-col>
        <ion-list>
          <ion-item lines="none">
            <ion-icon slot="start" src="../../../assets/icon/Calendar.svg" color="dark"></ion-icon>
            <p>{{date}}</p>
          </ion-item>
          <ion-item lines="none">
            <ion-icon slot="start" src="../../../assets/icon/local_dining-24px.svg" color="dark"></ion-icon>
            <p>{{plat.poste}}</p>
          </ion-item>
        </ion-list>
      </ion-col>
      <ion-col>
        <ion-list>
          <ion-item lines="none">
            <ion-icon slot="start" src="../../../assets/icon/Profile.svg" color="dark"></ion-icon>
            <p>{{userNom}} {{prenom}}</p>
          </ion-item>
          <ion-item lines="none">
            <ion-icon slot="start" src="../../../assets/icon/restaurant-24px.svg" color="dark"></ion-icon>
            <p>{{plat.portion}} Couverts</p>
          </ion-item>
        </ion-list>
      </ion-col>
    </ion-row>
  </ion-grid>
  <hr>
  <ion-grid>
    <ion-row>
      <ion-col class="ion-margin">
        <ion-label>
          Description commercial
        </ion-label>
        <p>
          {{plat.descriptionCommercial}}
        </p>
      </ion-col>
    </ion-row>
  </ion-grid>
  <hr>
  <ion-grid>
    <ion-row>
      <ion-col>
        <ion-list>
          <ion-item-divider class="list" (click)="showDenrees()">
            <ion-label>
              Denrées
            </ion-label>
            <ion-icon slot="end" [name]="chevronDenreesOn"></ion-icon>
          </ion-item-divider>
          <div [hidden]="denreesDisabled">
            <ion-grid [hidden]="tableau1">
              <ion-row>
                <ion-col class="ion-text-center">
                  <ion-label size="large">
                    Nature
                  </ion-label>
                </ion-col>
                <ion-col class="ion-text-center">
                  <ion-label size="large">
                    Unité
                  </ion-label>
                </ion-col>
                <ion-col class="ion-text-center">
                  <ion-label size="large">
                    Quantité
                  </ion-label>
                </ion-col>
              </ion-row>
              <ion-item-group *ngFor="let denree of newPlatDenrees | keyvalue; let i = index">
                <ion-item-divider (click)="denree.toggle=!denree.toggle">
                  <ion-label>{{denree.key}}</ion-label>
                  <ion-icon slot="end" [name]="!denree.toggle ? 'chevron-down-outline' : 'chevron-forward-outline'">
                  </ion-icon>
                </ion-item-divider>
                <div *ngIf="!denree.toggle">
                  <ion-row *ngFor="let value of denree.value; let i = index ">
                    <ion-col class="ion-text-center">{{value.produit}}</ion-col>
                    <ion-col class="ion-text-center"> {{value.unite}}</ion-col>
                    <ion-col class="ion-text-center"> {{value.quantite}}</ion-col>
                  </ion-row>
                </div>
              </ion-item-group>
            </ion-grid>
            <ion-grid [hidden]="tableau2">
              <ion-row>
                <ion-col class="ion-text-center">
                  <ion-label size="large">
                    Quantité
                  </ion-label>
                </ion-col>
                <ion-col class="ion-text-center">
                  <ion-label size="large">
                    Unité
                  </ion-label>
                </ion-col>
                <ion-col class="ion-text-center">
                  <ion-label size="large">
                    Nature
                  </ion-label>
                </ion-col>
              </ion-row>
              <ion-item-group *ngFor="let denree of newPlatDenrees | keyvalue; let i = index ">
                <ion-item-divider (click)="denree.toggle=!denree.toggle">
                  <ion-label>{{denree.key}}</ion-label>
                  <ion-icon slot="end" [name]="!denree.toggle ? 'chevron-down-outline' : 'chevron-forward-outline'">
                  </ion-icon>
                </ion-item-divider>
                <div *ngIf="!denree.toggle">
                  <ion-row *ngFor="let value of denree.value; let i = index ">
                    <ion-col class="ion-text-center"> {{value.quantite}}</ion-col>
                    <ion-col class="ion-text-center"> {{value.unite}}</ion-col>
                    <ion-col class="ion-text-center">{{value.produit}}</ion-col>
                  </ion-row>
                </div>
              </ion-item-group>
            </ion-grid>
          </div>
        </ion-list>
      </ion-col>
    </ion-row>
  </ion-grid>
  <hr>
  <ion-grid *ngFor="let fiche of plat.fichePreparation; let i = index; let odd=odd; let even=even;"
  [ngClass]="{ odd: odd, even: even }">
    <ion-row >
      <ion-col [ngClass]="{ odd: odd, even: even }">
        <ion-row [ngClass]="{ odd: odd, even: even }">
          <ion-item-divider [ngClass]="{ odd: odd, even: even }" (click)="fiche.toggle=!fiche.toggle">
            <ion-label color="primary">
              {{i + 1}} - {{fiche.nom}}
            </ion-label>
            <ion-icon slot="end" [name]="fiche.toggle ? 'chevron-down-outline' : 'chevron-forward-outline'"></ion-icon>
          </ion-item-divider>
        </ion-row>
        <div *ngIf="fiche.toggle">
          <ion-row [ngClass]="{ odd: odd, even: even }">
            <ion-col [ngClass]="{ odd: odd, even: even }">
              <ion-list>
                <ion-item-divider [ngClass]="{ odd: odd, even: even }"
                  (click)="fiche.denreesDisabled=!fiche.denreesDisabled">
                  <ion-label>
                    Denrées
                  </ion-label>
                  <ion-icon slot="end" [name]="chevronDenreesOn"></ion-icon>
                </ion-item-divider>
                <div *ngIf="!fiche.denreesDisabled">
                  <ion-grid [hidden]="tableau1" [ngClass]="{ odd: odd, even: even }">
                    <ion-row [ngClass]="{ odd: odd, even: even }">
                      <ion-col class="ion-text-center">
                        <ion-label size="large">
                          Nature
                        </ion-label>
                      </ion-col>
                      <ion-col class="ion-text-center">
                        <ion-label size="large">
                          Unité
                        </ion-label>
                      </ion-col>
                      <ion-col class="ion-text-center">
                        <ion-label size="large">
                          Quantité
                        </ion-label>
                      </ion-col>
                    </ion-row>
                    <ion-item-group *ngFor="let denree of fiche.denrees; let i = index"
                      [ngClass]="{ odd: odd, even: even }">
                      <!-- <ion-item-divider (click)="denree.toggle=!denree.toggle">
                        <ion-label>{{denree.key}}</ion-label>
                        <ion-icon slot="end"
                          [name]="!denree.toggle ? 'chevron-down-outline' : 'chevron-forward-outline'">
                        </ion-icon>
                      </ion-item-divider> -->
                      <!-- <div *ngIf="!denree.toggle">  
                        <ion-row > -->
                      <ion-row>
                        <ion-col class="ion-text-center">{{denree.produit}}</ion-col>
                        <ion-col class="ion-text-center"> {{denree.unite}}</ion-col>
                        <ion-col class="ion-text-center"> {{denree.quantite}}</ion-col>
                      </ion-row>
                      <!--  </ion-row>
                        </div> -->
                    </ion-item-group>
                  </ion-grid>
                  <ion-grid [hidden]="tableau2" [ngClass]="{ odd: odd, even: even }">
                    <ion-row [ngClass]="{ odd: odd, even: even }">
                      <ion-col class="ion-text-center">
                        <ion-label size="large">
                          Quantité
                        </ion-label>
                      </ion-col>
                      <ion-col class="ion-text-center">
                        <ion-label size="large">
                          Unité
                        </ion-label>
                      </ion-col>
                      <ion-col class="ion-text-center">
                        <ion-label size="large">
                          Nature
                        </ion-label>
                      </ion-col>
                    </ion-row>
                    <ion-item-group *ngFor="let denree of fiche.denrees; let i = index "
                      [ngClass]="{ odd: odd, even: even }">
                      <!-- <ion-item-divider (click)="denree.toggle=!denree.toggle">
                        <ion-label>{{denree.key}}</ion-label>
                        <ion-icon slot="end"
                          [name]="!denree.toggle ? 'chevron-down-outline' : 'chevron-forward-outline'">
                        </ion-icon>
                      </ion-item-divider>
                      <div *ngIf="!denree.toggle">
                        <ion-row *ngFor="let value of denree.value; let i = index "> -->
                      <ion-row>
                        <ion-col class="ion-text-center"> {{denree.quantite}}</ion-col>
                        <ion-col class="ion-text-center"> {{denree.unite}}</ion-col>
                        <ion-col class="ion-text-center">{{denree.produit}}</ion-col>
                      </ion-row>
                      <!-- </ion-row>
                      </div> -->
                    </ion-item-group>
                  </ion-grid>
                </div>
              </ion-list>
            </ion-col>
          </ion-row>
          
          <ion-row>
            <ion-col class="ion-margin">
              <p>
                {{fiche.descriptionTechniques}}
              </p>
            </ion-col>
          </ion-row>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
  <hr *ngIf="plat.descriptionTechnique">  
  <ion-grid  *ngIf="plat.descriptionTechnique">
    <ion-row>
      <ion-col class="ion-margin">
        <ion-label>
          Description technique
        </ion-label>
        <p>
          {{plat.descriptionTechnique}}
        </p>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>